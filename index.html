<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>NihonByte</title>
  <link rel="icon" type="image/png" href="./assets/favicon.png" />
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700;800&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="./style.css" />
</head>
<body>
  <div class="app-shell">
    <aside class="sidebar">
      <div class="brand">
        <img src="./assets/logo.png" alt="NihonByte" />
        <div>
          <h1>NihonByte</h1>
          <p>Roadmap + kosakata + komunitas real</p>
        </div>
      </div>

      <div class="auth-box" id="auth-box">
        <div id="logged-out">
          <button id="google-login" class="primary-btn">Masuk Google</button>
          <form id="email-form" class="email-form">
            <input id="email-input" type="email" placeholder="Email" required />
            <input id="password-input" type="password" placeholder="Password" required />
            <div class="auth-actions">
              <button type="button" id="email-login" class="ghost-btn">Masuk</button>
              <button type="button" id="email-register" class="ghost-btn">Daftar</button>
            </div>
          </form>
        </div>
        <div id="logged-in" class="hidden">
          <p id="user-text">Login sebagai -</p>
          <button id="logout" class="ghost-btn">Keluar</button>
        </div>
      </div>

      <nav class="sidebar-nav" id="sidebar-nav">
        <button class="nav-btn active" data-view="roadmap">üè† Learn</button>
        <button class="nav-btn" data-view="practice">üèãÔ∏è Practice</button>
        <button class="nav-btn" data-view="leaderboard">üõ°Ô∏è Leaderboard</button>
        <button class="nav-btn" data-view="missions">üéØ Quests</button>
        <button class="nav-btn" data-view="community">üë• Komunitas</button>
        <button class="nav-btn" data-view="profile">üßë Dasbor Saya</button>
      </nav>

      <details open class="sidebar-group">
        <summary>Kosa Kata & Tata Bahasa</summary>
        <button class="type-btn" data-type="verb-godan">Kata Kerja Godan</button>
        <button class="type-btn" data-type="verb-ru">Kata Kerja Ichidan</button>
        <button class="type-btn" data-type="verb-suru">Kata Kerja Suru</button>
        <button class="type-btn" data-type="adj-i">Kata Sifat -i</button>
        <button class="type-btn" data-type="adj-na">Kata Sifat -na</button>
        <button class="type-btn" data-type="noun">Kata Benda</button>
        <button class="type-btn" data-type="activity">Aktivitas</button>
        <button class="type-btn" data-type="expression">Ungkapan</button>
      </details>
    </aside>

    <main class="main-content">
      <header class="topbar">
        <div>
          <p class="status">Belajar Harian Aktif</p>
          <h2 id="page-title">Roadmap Belajar</h2>
        </div>
        <div class="stats" id="top-stats"></div>
      </header>

      <section class="view active" id="view-roadmap">
        <div class="roadmap-layout">
          <section>
            <article class="roadmap-hero">
              <p id="active-section">Section 1 ‚Ä¢ Unit 1</p>
              <h3 id="active-title">Form Basic Sentences</h3>
              <button id="continue-btn">Continue</button>
            </article>
            <div class="roadmap-path" id="roadmap-path"></div>
          </section>
          <aside class="panel">
            <div class="panel-head">
              <h3>Daily Missions</h3>
              <span>Reset 11 jam</span>
            </div>
            <div id="daily-missions"></div>
          </aside>
        </div>
      </section>

      <section class="view" id="view-practice">
        <div class="panel">
          <h3>Practice Developer Mode</h3>
          <div class="practice-controls">
            <label>Jenis
              <select id="practice-type">
                <option value="goi">Goi (Kosakata)</option>
                <option value="bunpou">Bunpou (Tata Bahasa)</option>
                <option value="dokkai">Dokkai (Membaca)</option>
              </select>
            </label>
            <label>Level
              <select id="practice-level">
                <option value="N5">N5</option>
                <option value="N4">N4</option>
                <option value="N3">N3</option>
                <option value="N2">N2</option>
                <option value="N1">N1</option>
              </select>
            </label>
            <button id="practice-start" class="primary-btn">Mulai Latihan</button>
          </div>
          <div id="quiz-list" class="card-grid"></div>
        </div>
        <div class="panel">
          <h3>Kosakata (dari data.js)</h3>
          <div id="vocab-list" class="card-grid"></div>
        </div>
      </section>

      <section class="view" id="view-leaderboard">
        <div class="panel"><h3>Leaderboard User Real</h3><div id="leaderboard-list"></div></div>
      </section>
      <section class="view" id="view-missions"><div class="panel"><h3>Misi Detail</h3><div id="mission-detail-list"></div></div></section>
      <section class="view" id="view-community"><div class="panel"><h3>Komunitas User Terdaftar</h3><div id="community-feed"></div></div></section>
      <section class="view" id="view-profile"><div class="panel" id="profile-card"></div></section>
    </main>
  </div>

  <dialog id="daily-login-modal" class="daily-modal">
    <div class="daily-card">
      <p>Daily login berhasil üî•</p>
      <h3 id="streak-count">Streak 1 hari</h3>
      <button id="daily-login-close">Lanjut belajar</button>
    </div>
  </dialog>

  <script src="./data.js"></script>
  <script src="./latihan/meta-data.js"></script>
  <script src="./latihan/data-goi.js"></script>
  <script src="./latihan/data-bunpou.js"></script>
  <script src="./latihan/data-dokkai.js"></script>
  <script src="./firebase-config.js"></script>
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.9.0/firebase-app.js";
    import { getAuth, GoogleAuthProvider, signInWithPopup, signOut, onAuthStateChanged, createUserWithEmailAndPassword, signInWithEmailAndPassword } from "https://www.gstatic.com/firebasejs/10.9.0/firebase-auth.js";
    import { getFirestore, doc, getDoc, setDoc, updateDoc, collection, getDocs, query, orderBy, limit, serverTimestamp } from "https://www.gstatic.com/firebasejs/10.9.0/firebase-firestore.js";

    const config = window.NIHONBYTE_FIREBASE_CONFIG;
    if (config?.apiKey && config?.projectId) {
      const app = initializeApp(config);
      window.firebaseAuth = getAuth(app);
      window.firebaseProvider = new GoogleAuthProvider();
      window.signInWithPopup = signInWithPopup;
      window.signOut = signOut;
      window.onAuthStateChanged = onAuthStateChanged;
      window.createUserWithEmailAndPassword = createUserWithEmailAndPassword;
      window.signInWithEmailAndPassword = signInWithEmailAndPassword;
      window.firebaseDb = getFirestore(app);
      window.fs = { doc, getDoc, setDoc, updateDoc, collection, getDocs, query, orderBy, limit, serverTimestamp };
      window.dispatchEvent(new Event("nihonbyte:firebase-ready"));
    } else {
      console.warn("Firebase config tidak valid / belum dimuat.");
    }
  </script>
  <script src="./app.js"></script>
</body>
</html>
